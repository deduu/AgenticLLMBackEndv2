import asyncio
from app.schemas.message_types import LLMRequest
from app.services.agentic import Agentic
from app.dependencies import small_model_pool, medium_model_pool
from app.services.message_preparer import MessagePreparer

# Assuming `Agentic` is implemented as shown
# and `model_pool` is already initialized and available in your application.

def main():
    # Create an instance of Agentic
    agentic_instance = Agentic(small_llm=small_model_pool, medium_llm=medium_model_pool)
    messagePreparer = MessagePreparer()
    
    # Assign the model_pool to simulate the LLM being loaded
    agentic_instance.is_model_loaded = True  # Assume model is already loaded

    # Create a test message
    test_message = LLMRequest(
        query="Apakah angka cadangan boleh 0?",
        history_messages="""
 Dalam konteks yang diberikan, terdapat beberapa definisi yang relevan dengan cadangan dan sumber daya migas. Pertama, definisi cadangan didefinisikan sebagai bagian volume IPIP yang diperkirakan dapat diambil secara komersial melalui kegiatan dalam proyek pengembangan yang telah ditetapkan. Faktor komersial yang menjadi batas adalah faktor teknis, keekonomian, regulasi dan legal, serta sosial dan lingkungan. Selanjutnya, definisi GOI Recoverable Resources (GRR) dinyatakan sebagai bagian volume IPIP yang diperkirakan dapat diambil dengan dibatasi hanya faktor teknis saja. GRR berada dalam kelas yang sama dengan cadangan, sehingga volume GRR tidak dapat dilaporkan sendiri tanpa nilai cadangan. Oleh karena itu, pencatatan angka cadangan selalu disertai dengan angka GRR. Klasifikasi sumber daya yang disebutkan juga menunjukkan bahwa cadangan adalah sumber daya yang sudah ditemukan dan telah memenuhi seluruh syarat-syarat komersial. Dengan demikian, cadangan didefinisikan lebih detail pada Definisi II.9. Dari informasi ini, terlihat bahwa angka cadangan dapat berada di kelas yang sama dengan GRR, sehingga angka cadangan tidak boleh berkurang atau menjadi nol kecuali dalam kondisi tertentu seperti ketidakpastian atau pendekatannya ke batas teknis. Namun, dalam beberapa kasus tertentu, angka cadangan bisa menjadi nol jika tidak ada sumber daya yang dapat diambil secara komersial. Namun, dalam konteks industri hulu migas Indonesia, angka cadangan biasanya dihitung berdasarkan skenario terbaik yang mempertimbangkan faktor teknis, keekonomian, regulasi dan legal, serta sosial dan lingkungan. Oleh karena itu, angka cadangan tidak boleh secara hukumnya menjadi nol kecuali dalam kondisi ekstrem yang tidak mungkin terjadi. Dengan demikian, angka cadangan boleh menjadi nol dalam beberapa situasi tertentu, tetapi biasanya dihitung berdasarkan skenario yang memastikan keberhasilan komersial dari proyek tersebut. </think> Apakah angka cadangan boleh 0? Tidak, angka cadangan biasanya dihitung berdasarkan skenario terbaik yang mempertimbangkan faktor teknis, keekonomian, regulasi dan legal, serta sosial dan lingkungan. Oleh karena itu, angka cadangan tidak boleh secara hukumnya menjadi nol kecuali dalam kondisi ekstrem yang tidak mungkin terjadi. Namun, dalam beberapa kasus tertentu, angka cadangan bisa menjadi nol jika tidak ada sumber daya yang dapat diambil secara komersial. [ksmi.md](user_data/pod/ksmi.md)(page 1) 
Jika project level suatu project di tahun lalu adalah E0 dan tahun ini tidak produksi, apakah project level di tahun ini masih bisa E0?
Dalam konteks yang diberikan, terdapat beberapa definisi penting yang relevan dengan pertanyaan pengguna. Pertama, definisi **E0 (On Production)** yang disebutkan dalam beberapa bagian konteks. Menurut definisi II.18, proyek yang sedang berproduksi tetapi tidak menghasilkan produksi komersial dapat tetap berada di level E0 selama satu WAP. Namun, jika dalam WAP selanjutnya proyek tersebut tidak berproduksi sama sekali, maka proyek tersebut tidak lagi berada di level E0. Selanjutnya, definisi **Production on Hold (E1)** menunjukkan bahwa jika proyek tidak berproduksi komersial dalam WAP sebelumnya, maka proyek harus pindah ke level lain, kecuali jika tetap terdaftar dalam dokumen rencana kerja pengembangan lapangan jangka panjang tiga tahun ke depan. Dengan demikian, jika proyek tahun lalu berada di level E0 (On Production) tetapi tidak menghasilkan produksi komersial, maka dalam tahun ini proyek tersebut harus pindah ke level E1 atau E4 tergantung pada kondisi dan dokumen yang relevan. Namun, dalam konteks yang diberikan, tidak ada informasi spesifik yang menentukan apakah proyek yang tidak menghasilkan produksi tetap bisa tetap di level E0 atau harus pindah. Oleh karena itu, perlu referensi lebih lanjut atau bahan baku eksternal untuk memastikan keputusan yang tepat. Tapi, berdasarkan definisi yang ada, jika proyek tidak menghasilkan produksi komersial dalam WAP sebelumnya, maka proyek tersebut harus pindah ke level lain, sehingga tidak mungkin tetap di level E0 dalam tahun ini. **Citations:** - [KSMI.md](user_data/pod/ksmi.md)(page 1) - Definisi E0 dan E1 - [DRAFT PTK POD](user_data/pod/Draft PTK POD Revisi 03_Status 010321_Fin.md)(page 1) - Proses evaluasi dan perubahan level proyek 
Jika suatu proyek tahun lalu berada di level E1 kemudian tahun ini tidak memiliki produksi kembali, akan tetapi proyek tersebut memiliki dokumen rencana kerja pengembangan lapangan jangka panjang, dimana level proyek selanjutnya untuk tahun depan?
Okay, so I need to figure out what the next level for the project would be after it was at E1 last year and didn't have production this year, but it has a long-term development plan document where the next level for the project in the coming year is determined based on whether it's still active in that plan. First, I'll look through the context provided. The context mentions several levels like E1 to E8, each with specific definitions. It also talks about the project maturity levels and how they transition over time based on certain conditions, like whether the project is still active in the long-term development plan. From the context, I see that after E1 (Production on Hold), the project must move to another level unless it's still listed in the long-term development plan. If it's no longer active in that plan, it has to move to the next level. The next level after E1 is E2 (Under Development), but that requires the FID (Financial Investment Decision) to be approved. If the FID isn't approved, the project might go to E5 (Development Unclarified) or E8 (Further Development Not Viable) depending on the specific circumstances. However, since the project has a long-term development plan, it can stay at E1 if it's still active in that plan. So, the next level depends on whether the project remains in the plan or not. If it does, it stays at E1; if not, it moves to E2 or another level. But the question is specifically about the next level for the coming year, so I think it's more about the transition based on the plan. The context mentions that if the project isn't active in the plan anymore, it must move levels. So, if it's still active, it stays at E1; if not, it goes to E2 or E5 or E8. Wait, but the context also says that the project can only stay at E1 if it's active in the long-term plan. So, the next level isn't necessarily E2 but depends on the plan's status. If the project is still in the plan, it remains E1; otherwise, it moves up. But the question is about the level for the coming year, so I think it's about the next step after E1, which could be E2 if the project is no longer in the plan or stays at E1 if it is. I think the answer is that the project will move to E2 (Under Development) if it's no longer in the long-term plan, otherwise, it stays at E1. But the context doesn't explicitly state the next level without knowing the plan's status, so maybe the answer is that it could move to E2 or E5 or E8 based on the plan's activity. Wait, the context says that if the project isn't active in the plan anymore, it must move levels. So, the next level after E1 is determined by whether it's still in the plan. If yes, E1; if no, then E2 or higher. But the question is about the level for the coming year, so it's about the transition. The context mentions that the project can stay at E1 if it's active in the plan, so the next level isn't necessarily E2 but depends on the plan's status. However, the context also says that if the project isn't active in the plan anymore, it must move levels. So, the answer is that the project will move to E2 (Under Development) if it's no longer in the plan, otherwise, it stays at E1. But the question is about the level for the coming year, so it's about the next step after E1, which could be E2 if the project is no longer in the plan or stays at E1 if it is. I think the answer is that the project will move to E2 (Under Development) if it's no longer active in the long-term plan, otherwise, it remains at E1. But since the question is about the level for the coming year, it's about the transition based on the plan's status. So, the next level is E2 if the project isn't in the plan anymore, else E1. But the context doesn't specify whether the project is still in the plan, so maybe the answer is that it could move to E2 or stay at E1 depending on the plan's activity. Wait, the context says that the project can stay at E1 if it's active in the plan. So, the next level isn't determined by time but by the plan's status. Therefore, the answer is that the project will stay at E1 if it's still in the plan, otherwise, it moves to E2 or higher. But the question is about the level for the coming year, so it's about the next step after E1, which is E2 if the project isn't in the plan anymore. I think the 
Bagaimana cara menaikkan project level dari dari E3 ke E2?
Okay, so I need to figure out how to increase the project level from E3 to E2 based on the provided context. Let me start by understanding what E3 and E2 mean according to the context. From the context, I see that E3 is "Justified for Development (E3)". The definition says that a project is at E3 if it has the production license and Financial Investment Decision (FID) approved. It can only last for up to three WAPs unless extended. If it doesn't get FID approval within that time or the on-stream date isn't met, it moves to E2, which is "Under Development (E2)". E2 is when the project is in the development phase, right after getting the production license but before the FID is approved. So, to move from E3 to E2, the project must not have the FID approved anymore. That means the project is still in the development phase but hasn't yet received the final approval needed to move to production. The key here is that the FID hasn't been set yet, so the project is still under development. Looking at the context, there's a section on the project maturity levels. It shows that E3 is just before E2, and E2 is the next step once the FID is approved. If the FID isn't approved, the project drops to E2. So, the process involves waiting for the FID decision. If it's denied or not met, the project level goes down to E2. I also see a flowchart that illustrates the project's progression. It shows E3 leading to E2 if FID isn't approved. So, the transition from E3 to E2 is triggered by the lack of FID approval. Therefore, to increase the project level from E3 to E2, the project must not have the FID approved anymore. This means the project is still in the development phase but hasn't yet reached the point where FID is granted, thus moving to E2. </think> Untuk meningkatkan level proyek dari E3 ke E2, proyek tersebut harus tidak lagi memiliki izin berproduksi yang diberikan setelah durasi waktu yang ditetapkan dalam level Justified for Development terlewati atau tanggal rencana on-stream tidak tercapai pada WAP sebelumnya. Pada WAP selanjutnya, proyek tersebut harus pindah ke level Under Development (E2) karena tidak mendapatkan Financial Investment Decision (FID) yang disetujui. **Citations:** - [KSMI.md](user_data/pod/ksmi.md)(#) - [KSMI.md](user_data/pod/ksmi.md)(#) """
        # history_messages=[{"role": "user", "content": "Tell me about AI"}]
    )

    # Test the understand method
    async def run_understand():
        Subqueries = await agentic_instance.understand(test_message)
        print("Subqueries:", Subqueries)

     

    # Run the asynchronous test
    asyncio.run(run_understand())

if __name__ == "__main__":
    main()
